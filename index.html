<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Harmonogram Salonu Kosmetycznego</title>
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            color: #333;
            line-height: 1.6;
            padding: 10px;
        }
        
        .view {
            display: none;
        }
        
        .active-view {
            display: block;
        }
        
        .login-container, .employee-select {
            max-width: 500px;
            margin: 20px auto;
            padding: 20px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 15px;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }
        
        h1, h2, h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        h1 {
            text-align: center;
            font-size: 1.8rem;
            padding-bottom: 15px;
            border-bottom: 2px solid #eee;
            margin-top: 10px;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            flex-wrap: wrap;
            gap: 10px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
        }
        
        .calendar-nav {
            display: flex;
            gap: 10px;
            align-items: center;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 12px 18px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            min-height: 44px;
        }
        
        button:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 6px 8px rgba(0,0,0,0.15);
        }
        
        button.delete {
            background: #e74c3c;
        }
        
        button.delete:hover {
            background: #c0392b;
        }
        
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            border-bottom: 1px solid #ddd;
            padding-bottom: 10px;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            padding: 10px 15px;
            cursor: pointer;
            border-radius: 8px;
            background: #f1f5f9;
            transition: all 0.3s;
            font-weight: 600;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            min-height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            flex: 1;
            text-align: center;
            min-width: 120px;
        }
        
        .nav-tab.active {
            background: #3498db;
            color: white;
        }
        
        select {
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            min-height: 44px;
        }
        
        .calendar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .day-header {
            text-align: center;
            font-weight: bold;
            padding: 10px;
            background: #5d6d7e;
            color: white;
            border-radius: 8px;
            font-size: 1rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .day {
            border: 1px solid #e0e0e0;
            padding: 10px;
            min-height: 100px;
            background: white;
            cursor: pointer;
            position: relative;
            transition: all 0.3s;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            display: flex;
            flex-direction: column;
        }
        
        .day:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 15px rgba(0,0,0,0.1);
            background: #f0f7ff;
            border-color: #3498db;
        }
        
        .today {
            background-color: #e1f5fe;
            border: 2px solid #3498db;
        }
        
        .day-number {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
            color: #2c3e50;
            align-self: flex-start;
            background: #f8f9fa;
            padding: 3px 8px;
            border-radius: 20px;
        }
        
        .appointment {
            font-size: 0.8rem;
            margin: 4px 0;
            padding: 6px;
            background: #e8f5e9;
            border-radius: 6px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            border-left: 4px solid #2ecc71;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .day-details {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            display: none;
            border: 1px solid #e0e0e0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .appointment-item {
            display: flex;
            justify-content: space-between;
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 10px;
            align-items: center;
            border-left: 4px solid #3498db;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        
        .appointment-details {
            flex: 1;
        }
        
        .appointment-actions {
            display: flex;
            gap: 8px;
        }
        
        input, select {
            padding: 12px;
            margin: 8px 0;
            border: 1px solid #ddd;
            border-radius: 8px;
            width: 100%;
            font-size: 1rem;
            background: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
            min-height: 44px;
        }
        
        .add-appointment {
            margin: 20px 0;
            padding: 20px;
            background: #f0f7ff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .time-inputs {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .time-inputs select {
            flex: 1;
        }
        
        .summary, .month-summary {
            margin-top: 20px;
            padding: 20px;
            background: #e9f7ef;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .month-summary {
            background: #e3f2fd;
        }
        
        .summary h3, .month-summary h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3rem;
        }
        
        .summary p, .month-summary p {
            font-size: 1.1rem;
            margin: 8px 0;
        }
        
        .timeline-container {
            position: relative;
            height: 400px;
            margin-top: 20px;
            border: 1px solid #ddd;
            border-radius: 12px;
            overflow: hidden;
            background: repeating-linear-gradient(
                to bottom,
                #f9f9f9,
                #f9f9f9 30px,
                #eee 30px,
                #eee 60px
            );
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .hour-marker {
            position: absolute;
            left: 0;
            width: 100%;
            height: 1px;
            background: #ccc;
            z-index: 1;
        }
        
        .hour-label {
            position: absolute;
            left: 10px;
            font-size: 0.8rem;
            color: #555;
            background: rgba(255,255,255,0.9);
            padding: 4px 8px;
            border-radius: 4px;
            z-index: 2;
            font-weight: 500;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .booked-slot {
            position: absolute;
            width: 100%;
            background: rgba(231, 76, 60, 0.15);
            border: 1px solid #e74c3c;
            box-sizing: border-box;
            z-index: 3;
            transition: all 0.3s;
            border-radius: 6px;
            padding: 6px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            box-shadow: 0 3px 8px rgba(0,0,0,0.1);
        }
        
        .booked-slot:hover {
            background: rgba(231, 76, 60, 0.25);
            z-index: 4;
            transform: scale(1.02);
        }
        
        .other-employee-slot {
            background: rgba(155, 89, 182, 0.15);
            border: 1px solid #9b59b6;
        }
        
        .other-employee-slot:hover {
            background: rgba(155, 89, 182, 0.25);
        }
        
        .pedicure-block {
            background: rgba(52, 152, 219, 0.15);
            border: 1px solid #3498db;
        }
        
        .slot-info {
            font-size: 0.85rem;
            color: #333;
            font-weight: bold;
            width: 100%;
            text-align: center;
        }
        
        .slot-info div {
            margin-bottom: 3px;
        }
        
        .slot-delete {
            position: absolute;
            right: 5px;
            top: 5px;
            background: #e74c3c;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            padding: 4px 8px;
            font-size: 0.8rem;
            font-weight: bold;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .duration-slider-container {
            margin: 20px 0;
            padding: 15px;
            background: #f0f7ff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .duration-slider {
            width: 100%;
            margin: 15px 0;
        }
        
        .duration-value {
            display: flex;
            justify-content: space-between;
            margin-top: 12px;
            font-size: 1rem;
        }
        
        .duration-display {
            font-weight: bold;
            font-size: 1.1rem;
            color: #2980b9;
        }
        
        input[type="range"] {
            height: 10px;
            -webkit-appearance: none;
            background: #dde6f0;
            border-radius: 5px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 25px;
            height: 25px;
            background: #3498db;
            border-radius: 50%;
            cursor: pointer;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .empty {
            background: #f9f9f9;
            border: 1px dashed #ddd;
            cursor: default;
        }
        
        .empty:hover {
            transform: none;
            box-shadow: none;
            background: #f9f9f9;
        }
        
        #login-error {
            color: #e74c3c;
            margin-top: 15px;
            font-weight: 600;
        }
        
        .employee-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            background: #f1f5f9;
            padding: 12px;
            border-radius: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .service-category {
            margin: 15px 0;
            padding: 15px;
            background: #f0f7ff;
            border-radius: 12px;
            border-left: 5px solid #3498db;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .service-category h4 {
            color: #2980b9;
            margin-bottom: 10px;
            font-size: 1.1rem;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .service-options {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 12px;
        }
        
        .service-option {
            padding: 12px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        
        .service-option:hover {
            background: #e3f2fd;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-color: #3498db;
        }
        
        .service-option.selected {
            background: #bbdefb;
            border-color: #64b5f6;
            font-weight: bold;
        }
        
        .selected-service {
            margin-top: 15px;
            padding: 12px;
            background: #e8f5e9;
            border-radius: 8px;
            font-weight: bold;
            border-left: 5px solid #2ecc71;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        
        .service-container {
            max-height: 400px;
            overflow-y: auto;
            padding: 12px;
            border: 1px solid #eee;
            border-radius: 12px;
            margin: 15px 0;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .other-service-input {
            margin-top: 10px;
            display: none;
        }
        
        .other-employee-note {
            color: #9b59b6;
            font-size: 0.85rem;
            margin-top: 5px;
            font-weight: bold;
        }
        
        .clients-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border-radius: 10px;
            overflow: hidden;
        }
        
        .clients-table th, .clients-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .clients-table th {
            background-color: #5d6d7e;
            color: white;
        }
        
        .clients-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .clients-table tr:hover {
            background-color: #e3f2fd;
        }
        
        .client-form {
            margin-top: 20px;
            padding: 20px;
            background: #f0f7ff;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .form-row {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .form-group {
            flex: 1;
            min-width: 200px;
        }
        
        .autocomplete-items {
            position: absolute;
            border: 1px solid #d4d4d4;
            border-bottom: none;
            border-top: none;
            z-index: 99;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            max-height: 200px;
            overflow-y: auto;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border-radius: 0 0 8px 8px;
        }
        
        .autocomplete-item {
            padding: 10px;
            cursor: pointer;
            background-color: #fff; 
            border-bottom: 1px solid #d4d4d4; 
        }
        
        .autocomplete-item:hover {
            background-color: #e9e9e9; 
        }
        
        .autocomplete-active {
            background-color: #3498db !important;
            color: #ffffff;
        }
        
        .autocomplete-container {
            position: relative;
        }
        
        .employee-list {
            margin-top: 20px;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        }
        
        .employee-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            margin: 10px 0;
            background: white;
            border-radius: 10px;
            border-left: 5px solid #3498db;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        
        .pedicure-warning {
            color: #e74c3c;
            font-weight: bold;
            background: #ffebee;
            padding: 10px;
            border-radius: 8px;
            margin-top: 8px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
        
        /* Harmonogram dnia */
        .day-schedule {
            display: flex;
            gap: 20px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .schedule-column {
            flex: 1;
            border: 1px solid #ddd;
            border-radius: 12px;
            padding: 15px;
            background: white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            min-width: 300px;
        }
        
        .schedule-column h3 {
            text-align: center;
            margin-bottom: 15px;
            color: #2c3e50;
            padding-bottom: 12px;
            border-bottom: 1px solid #eee;
        }
        
        .appointments-table {
            width: 100%;
            border-collapse: collapse;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
            border-radius: 8px;
            overflow: hidden;
        }
        
        .appointments-table th, .appointments-table td {
            border: 1px solid #ddd;
            padding: 12px;
            text-align: left;
        }
        
        .appointments-table th {
            background-color: #5d6d7e;
            color: white;
        }
        
        .appointments-table tr:nth-child(even) {
            background-color: #f2f2f2;
        }
        
        .appointments-table tr:hover {
            background-color: #e3f2fd;
        }
        
        .price-input {
            width: 80px;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 1rem;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05);
        }
        
        .pedicure-row {
            background-color: #ffe6e6 !important;
        }
        
        .schedule-column .empty-schedule {
            text-align: center;
            padding: 20px;
            color: #777;
            font-style: italic;
            font-size: 1rem;
        }
        
        .pedicure-blocked {
            background-color: #ffcccc !important;
            color: #cc0000;
            font-weight: bold;
        }
        
        /* Nowe elementy wizualne */
        .logo-header {
            text-align: center;
            margin-bottom: 20px;
        }
        
        .logo-header h1 {
            font-size: 2rem;
            color: #2c3e50;
            margin-bottom: 8px;
        }
        
        .logo-header p {
            color: #5d6d7e;
            font-size: 1rem;
        }
        
        .stats-container {
            display: flex;
            gap: 15px;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        
        .stat-box {
            flex: 1;
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            min-width: 200px;
        }
        
        .stat-box h3 {
            color: #3498db;
            font-size: 1.2rem;
            margin-bottom: 12px;
        }
        
        .stat-value {
            font-size: 1.8rem;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .stat-label {
            color: #5d6d7e;
            margin-top: 8px;
            font-size: 1rem;
        }
        
        .day-navigation {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .reset-stats {
            background: #e74c3c;
            margin-top: 12px;
        }
        
        /* Responsywność */
        @media (max-width: 992px) {
            .form-row, .stats-container {
                flex-direction: column;
            }
            
            .service-options {
                grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            }
            
            .day-schedule {
                flex-direction: column;
            }
            
            .day-navigation {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        @media (max-width: 768px) {
            .calendar {
                grid-template-columns: repeat(1, 1fr);
            }
            
            .day-header {
                display: none;
            }
            
            .time-inputs {
                flex-direction: column;
            }
            
            .nav-tabs {
                flex-direction: column;
            }
            
            .container, .login-container, .employee-select {
                padding: 15px;
                margin: 10px auto;
            }
            
            .calendar-header {
                flex-direction: column;
                gap: 10px;
                text-align: center;
            }
            
            .calendar-nav {
                justify-content: center;
            }
            
            .employee-header {
                flex-direction: column;
                gap: 10px;
            }
            
            .stats-container {
                flex-direction: column;
            }
            
            .day-schedule {
                flex-direction: column;
            }
            
            .appointments-table th, 
            .appointments-table td,
            .clients-table th,
            .clients-table td {
                padding: 10px;
                font-size: 0.9rem;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 5px;
            }
            
            h1 {
                font-size: 1.5rem;
            }
            
            h2 {
                font-size: 1.2rem;
            }
            
            h3 {
                font-size: 1.1rem;
            }
            
            .nav-tabs {
                flex-wrap: wrap;
            }
            
            .nav-tab {
                padding: 8px 12px;
                font-size: 0.9rem;
            }
            
            button {
                padding: 10px 15px;
                font-size: 0.9rem;
            }
            
            .calendar {
                grid-template-columns: repeat(1, 1fr);
                gap: 8px;
            }
            
            .day {
                min-height: 80px;
                padding: 8px;
            }
            
            .day-number {
                font-size: 1rem;
            }
            
            .appointment {
                font-size: 0.75rem;
                padding: 4px;
            }
            
            .service-options {
                grid-template-columns: 1fr;
            }
            
            .form-row {
                flex-direction: column;
            }
            
            .timeline-container {
                height: 350px;
            }
            
            /* Dodatkowe style dla dni w kalendarzu na mobilkach */
            .day-header-mobile {
                display: block;
                font-weight: bold;
                margin-bottom: 5px;
                color: #2c3e50;
            }
        }

        /* Dodatkowe poprawki dla bardzo małych ekranów */
        @media (max-width: 360px) {
            .calendar-header h2 {
                font-size: 1.1rem;
            }
            
            .logo-header h1 {
                font-size: 1.6rem;
            }
            
            .logo-header p {
                font-size: 0.9rem;
            }
            
            .stat-value {
                font-size: 1.5rem;
            }
            
            .stat-box {
                min-width: 100%;
            }
        }
        
        /* Przewijane tabele na małych ekranach */
        .table-wrapper {
            overflow-x: auto;
            margin-top: 15px;
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0,0,0,0.05);
        }
    </style>
</head>
<body>
    <!-- Ekran logowania -->
    <div id="login-view" class="view active-view login-container">
        <div class="logo-header">
            <h1>Harmonogram Salonu</h1>
            <p>Profesjonalne zarządzanie wizytami</p>
        </div>
        <input type="password" id="password" placeholder="Wprowadź hasło">
        <button onclick="login()">Zaloguj</button>
        <p id="login-error"></p>
    </div>

    <!-- Wybór pracownika -->
    <div id="employee-view" class="view employee-select">
        <div class="logo-header">
            <h1>Wybierz pracownika</h1>
            <p>Kontynuuj do swojego harmonogramu</p>
        </div>
        
        <div class="employee-list" id="employee-list">
            <!-- Lista pracowników będzie dodana dynamicznie -->
        </div>
    </div>

    <!-- Główny kalendarz -->
    <div id="calendar-view" class="view container">
        <div class="nav-tabs">
            <div class="nav-tab active" onclick="showView('calendar-view')">Kalendarz</div>
            <div class="nav-tab" onclick="showView('clients-view')">Baza Klientów</div>
            <div class="nav-tab" onclick="showView('employees-view')">Pracownicy</div>
            <div class="nav-tab" onclick="showView('stats-view')">Statystyki</div>
        </div>
        
        <div class="employee-header">
            <div>
                <h1>Harmonogram Pracy</h1>
                <h2 id="employee-name" style="color: #3498db;"></h2>
            </div>
            <button id="switch-employee-btn" onclick="switchEmployee()">Zmień pracownika</button>
        </div>
        
        <div class="calendar-header">
            <div class="calendar-nav">
                <button id="prev-month">← Poprz.</button>
                <h2 id="current-month">Lipiec 2024</h2>
                <button id="next-month">Nast. →</button>
            </div>
            
            <div>
                <button onclick="showCurrentDate()">Dzisiaj</button>
            </div>
        </div>
        
        <div class="calendar" id="calendar">
            <!-- Nagłówki dni tygodnia będą dodane dynamicznie -->
        </div>
        
        <div class="stats-container">
            <div class="stat-box">
                <h3>Zarobki miesiąca</h3>
                <div class="stat-value"><span id="monthly-earnings">0</span> zł</div>
                <div class="stat-label">Łącznie w tym miesiącu</div>
                <button class="reset-stats" onclick="resetMonthlyStats()">Wyzeruj</button>
            </div>
            
            <div class="stat-box">
                <h3>Nadchodzące wizyty</h3>
                <div class="stat-value"><span id="upcoming-appointments">0</span></div>
                <div class="stat-label">W najbliższych 7 dniach</div>
            </div>
            
            <div class="stat-box">
                <h3>Nowi klienci</h3>
                <div class="stat-value"><span id="new-clients">0</span></div>
                <div class="stat-label">W tym miesiącu</div>
            </div>
        </div>
        
        <div class="day-details" id="day-details">
            <div class="day-navigation">
                <button onclick="navigateDay(-1)">← Poprz. dzień</button>
                <h3 id="selected-day">24 Lipca 2024</h3>
                <button onclick="navigateDay(1)">Nast. dzień →</button>
            </div>
            
            <button onclick="hideDayDetails()">← Wróć do kalendarza</button>
            
            <div class="add-appointment">
                <h3>Dodaj wizytę</h3>
                
                <div class="autocomplete-container">
                    <input type="text" id="client-name" placeholder="Imię klienta" autocomplete="off">
                    <div id="autocomplete-list" class="autocomplete-items"></div>
                </div>
                
                <input type="text" id="client-phone" placeholder="Numer telefonu">
                
                <h4>Wybierz usługę:</h4>
                <div class="service-container" id="service-options-container">
                    <!-- Usługi będą renderowane dynamicznie -->
                </div>
                
                <div class="selected-service">
                    Wybrana usługa: <span id="selected-service">Brak</span>
                </div>
                
                <div class="time-inputs">
                    <select id="start-hour">
                        <option value="">Godzina rozpoczęcia</option>
                    </select>
                </div>
                
                <div class="duration-slider-container">
                    <h4>Czas trwania usługi:</h4>
                    <input type="range" id="duration-slider" min="5" max="300" step="5" value="30" class="duration-slider">
                    <div class="duration-value">
                        <span>5 min</span>
                        <span id="duration-display" class="duration-display">30 min</span>
                        <span>5 godz.</span>
                    </div>
                </div>
                
                <button onclick="addAppointment()">Dodaj wizytę</button>
                <p id="time-error" style="color:#e74c3c;"></p>
            </div>
            
            <h3>Harmonogram dnia</h3>
            <div class="timeline-container" id="timeline-container"></div>
            
            <h3>Lista wizyt</h3>
            <div class="table-wrapper">
                <div class="day-schedule" id="day-schedule">
                    <!-- Harmonogram dnia w dwóch kolumnach -->
                </div>
            </div>
            
            <div class="summary">
                <h3>Podsumowanie dnia</h3>
                <p>Liczba wizyt: <span id="day-count">0</span></p>
                <p>Zarobki: <span id="day-earnings">0</span> zł</p>
                <button class="reset-stats" onclick="resetDayStats()">Wyzeruj zarobki dnia</button>
            </div>
        </div>
    </div>

    <!-- Baza klientów -->
    <div id="clients-view" class="view container">
        <div class="nav-tabs">
            <div class="nav-tab" onclick="showView('calendar-view')">Kalendarz</div>
            <div class="nav-tab active" onclick="showView('clients-view')">Baza Klientów</div>
            <div class="nav-tab" onclick="showView('employees-view')">Pracownicy</div>
            <div class="nav-tab" onclick="showView('stats-view')">Statystyki</div>
        </div>
        
        <h1>Baza Klientów</h1>
        
        <div class="client-form">
            <h3>Dodaj nowego klienta</h3>
            <div class="form-row">
                <div class="form-group">
                    <label>Imię i nazwisko</label>
                    <input type="text" id="new-client-name" placeholder="Imię i nazwisko">
                </div>
                <div class="form-group">
                    <label>Numer telefonu</label>
                    <input type="text" id="new-client-phone" placeholder="Numer telefonu">
                </div>
            </div>
            <div class="form-group">
                <label>Notatki</label>
                <textarea id="new-client-notes" placeholder="Notatki o kliencie" rows="3"></textarea>
            </div>
            <button onclick="addClient()">Dodaj klienta</button>
        </div>
        
        <div class="table-wrapper">
            <table class="clients-table">
                <thead>
                    <tr>
                        <th>Imię i nazwisko</th>
                        <th>Numer telefonu</th>
                        <th>Notatki</th>
                        <th>Akcje</th>
                    </tr>
                </thead>
                <tbody id="clients-list">
                    <!-- Klienci będą dodawani dynamicznie -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Zarządzanie pracownikami -->
    <div id="employees-view" class="view container">
        <div class="nav-tabs">
            <div class="nav-tab" onclick="showView('calendar-view')">Kalendarz</div>
            <div class="nav-tab" onclick="showView('clients-view')">Baza Klientów</div>
            <div class="nav-tab active" onclick="showView('employees-view')">Pracownicy</div>
            <div class="nav-tab" onclick="showView('stats-view')">Statystyki</div>
        </div>
        
        <h1>Zarządzanie pracownikami</h1>
        
        <div class="add-appointment">
            <h3>Dodaj nowego pracownika</h3>
            <input type="text" id="new-employee-name" placeholder="Imię i nazwisko pracownika">
            <button onclick="addEmployee()" style="margin-top: 15px;">Dodaj pracownika</button>
        </div>
        
        <div class="table-wrapper">
            <table class="clients-table">
                <thead>
                    <tr>
                        <th>Imię i nazwisko</th>
                        <th>Akcje</th>
                    </tr>
                </thead>
                <tbody id="employees-table">
                    <!-- Lista pracowników będzie dodana dynamicznie -->
                </tbody>
            </table>
        </div>
    </div>

    <!-- Statystyki -->
    <div id="stats-view" class="view container">
        <div class="nav-tabs">
            <div class="nav-tab" onclick="showView('calendar-view')">Kalendarz</div>
            <div class="nav-tab" onclick="showView('clients-view')">Baza Klientów</div>
            <div class="nav-tab" onclick="showView('employees-view')">Pracownicy</div>
            <div class="nav-tab active" onclick="showView('stats-view')">Statystyki</div>
        </div>
        
        <h1>Statystyki Salonu</h1>
        
        <div class="stats-container">
            <div class="stat-box">
                <h3>Łączne zarobki</h3>
                <div class="stat-value">12,540 zł</div>
                <div class="stat-label">W tym miesiącu</div>
                <button class="reset-stats" onclick="resetAllStats()">Wyzeruj</button>
            </div>
            
            <div class="stat-box">
                <h3>Wykonane usługi</h3>
                <div class="stat-value">187</div>
                <div class="stat-label">W tym miesiącu</div>
            </div>
            
            <div class="stat-box">
                <h3>Nowi klienci</h3>
                <div class="stat-value">42</div>
                <div class="stat-label">W tym miesiącu</div>
            </div>
        </div>
        
        <div class="summary" style="margin-top: 30px;">
            <h3>Statystyki pracowników</h3>
            <div id="employee-stats-container" style="margin-top: 20px; display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px;">
                <!-- Statystyki pracowników będą dodane dynamicznie -->
            </div>
        </div>
    </div>

    <script>
        // Lista usług
        const services = [
            {
                category: "💅 MANICURE",
                items: [
                    "MANICURE BIOLOGICZNY (opracowanie skórek i kształtu + odżywka)",
                    "MANICURE HYBRYDOWY",
                    "UTWARDZENIE NATURALNEJ PŁYTKI ŻELEM / UZUPEŁNIENIE",
                    "MANICURE ŻELOWY Z PRZEDŁUŻENIEM",
                    "REKONSTRUKCJA PAZNOKCI OGRYZIONYCH"
                ]
            },
            {
                category: "✨ DODATKOWE USŁUGI",
                items: [
                    "NAPRAWA JEDNEGO PAZNOKCIA PO TERMINIE REKLAMACJI",
                    "ZDOBIENIE",
                    "FRENCH / OMBRE",
                    "OMBRE 3 KOLOROWE",
                    "ZDOBIENIE PRINCESS NAILS",
                    "CYRKONIE",
                    "ŚCIĄGNIĘCIE STYLIZACJI HYBRYDOWEJ + MANICURE BIOLOGICZNY",
                    "ŚCIĄGNIĘCIE STYLIZACJI ŻELOWEJ + MANICURE BIOLOGICZNY",
                    "ŚCIĄGNIĘCIE STYLIZACJI HYBRYDOWEJ PO INNEJ STYLISTCE",
                    "ŚCIĄGNIĘCIE STYLIZACJI ŻELOWEJ PO INNEJ STYLISTCE"
                ]
            },
            {
                category: "🦶 PEDICURE",
                items: [
                    "PEDICURE BIOLOGICZNY (opracowanie skórek i kształtu + odżywka)",
                    "PEDICURE HYBRYDOWY",
                    "OPRACOWANIE PODESZWY Z MASAŻEM + PEDICURE HYBRYDOWY",
                    "OPRACOWANIE PODESZWY Z MASAŻEM + PEDICURE BIOLOGICZNY"
                ]
            },
            {
                category: "👁️ STYLIZACJA BRWI I RZĘS",
                items: [
                    "REGULACJA BRWI",
                    "HENNA KLASYCZNA + REGULACJA BRWI",
                    "HENNA PUDROWA + REGULACJA BRWI",
                    "HENNA RZĘS"
                ]
            },
            {
                category: "🕊️ DEPILACJA WOSKIEM",
                items: [
                    "WĄSIK",
                    "BRODA",
                    "BRODA + SZYJA",
                    "BACZKI",
                    "CAŁA TWARZ"
                ]
            },
            {
                category: "💄 MAKIJAŻ",
                items: [
                    "MAKIJAŻ ŚLUBNY / OKOLICZNOŚCIOWY",
                    "MAKIJAŻ ŚLUBNY / OKOLICZNOŚCIOWY W NIEDZIELE I ŚWIĘTA"
                ]
            },
            {
                category: "📝 INNE USŁUGI",
                items: ["Inna usługa..."]
            }
        ];

        // Dane
        let currentDate = new Date();
        let currentMonth = currentDate.getMonth();
        let currentYear = currentDate.getFullYear();
        let selectedDay = null;
        let currentEmployee = null;
        let selectedDuration = 30;
        let selectedService = "";
        
        // Zmienne do nawigacji dni
        let currentDetailDay = null;
        let currentDetailMonth = null;
        let currentDetailYear = null;
        
        // Inicjalizacja danych
        let employeesData = [];
        let appointmentsData = {};
        let clientsData = [];

        // Funkcje pomocnicze
        function timeToMinutes(timeStr) {
            const [hours, minutes] = timeStr.split(':').map(Number);
            return hours * 60 + minutes;
        }

        function minutesToTime(minutes) {
            const hours = Math.floor(minutes / 60) % 24;
            const mins = minutes % 60;
            return `${hours.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}`;
        }

        function formatDuration(minutes) {
            const hours = Math.floor(minutes / 60);
            const mins = minutes % 60;
            return hours > 0 ? `${hours}h ${mins}min` : `${mins} min`;
        }
        
        function showView(viewId) {
            document.querySelectorAll('.view').forEach(view => {
                view.classList.remove('active-view');
            });
            document.getElementById(viewId).classList.add('active-view');
            
            if (viewId === 'stats-view') {
                renderEmployeeStats();
            }
        }

        // Inicjalizacja
        function initTimeOptions() {
            const startHourSelect = document.getElementById('start-hour');
            startHourSelect.innerHTML = '<option value="">Godzina rozpoczęcia</option>';
            
            // Harmonogram zaczyna się od 5:00
            for (let hour = 5; hour < 24; hour++) {
                for (let minute = 0; minute < 60; minute += 5) {
                    const time = `${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`;
                    const option = document.createElement('option');
                    option.value = time;
                    option.textContent = time;
                    startHourSelect.appendChild(option);
                }
            }
            
            const slider = document.getElementById('duration-slider');
            const display = document.getElementById('duration-display');
            
            slider.value = selectedDuration;
            display.textContent = formatDuration(selectedDuration);
            
            slider.addEventListener('input', function() {
                selectedDuration = parseInt(this.value);
                display.textContent = formatDuration(selectedDuration);
                updateAvailableTimes();
            });
            
            renderServiceOptions();
            renderClientsList();
            renderEmployeesList();
            renderEmployeesTable();
            
            // Autouzupełnianie dla klientów
            document.getElementById('client-name').addEventListener('input', function() {
                const input = this.value.toLowerCase();
                const autocompleteList = document.getElementById('autocomplete-list');
                autocompleteList.innerHTML = '';
                
                if (input.length < 2) return;
                
                const matches = clientsData.filter(client => 
                    client.name.toLowerCase().includes(input)
                );
                
                if (matches.length > 0) {
                    matches.forEach(client => {
                        const item = document.createElement('div');
                        item.className = 'autocomplete-item';
                        item.innerHTML = `<strong>${client.name}</strong> - ${client.phone}`;
                        item.addEventListener('click', () => {
                            document.getElementById('client-name').value = client.name;
                            document.getElementById('client-phone').value = client.phone;
                            autocompleteList.innerHTML = '';
                        });
                        autocompleteList.appendChild(item);
                    });
                }
            });
        }
        
        function renderEmployeesList() {
            const listEl = document.getElementById('employee-list');
            listEl.innerHTML = '<h3>Lista pracowników</h3>';
            
            employeesData.forEach(employee => {
                const employeeEl = document.createElement('div');
                employeeEl.className = 'employee-item';
                employeeEl.innerHTML = `
                    <div>${employee.name}</div>
                    <div>
                        <button onclick="selectEmployee(${employee.id})">Wybierz</button>
                    </div>
                `;
                listEl.appendChild(employeeEl);
            });
        }
        
        function renderEmployeesTable() {
            const tableBody = document.getElementById('employees-table');
            tableBody.innerHTML = '';
            
            employeesData.forEach(employee => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${employee.name}</td>
                    <td>
                        <button onclick="editEmployee(${employee.id})">Edytuj</button>
                        <button class="delete" onclick="deleteEmployee(${employee.id})">Usuń</button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        function renderServiceOptions() {
            const container = document.getElementById('service-options-container');
            container.innerHTML = '';
            
            services.forEach(category => {
                const categoryEl = document.createElement('div');
                categoryEl.className = 'service-category';
                categoryEl.innerHTML = `<h4>${category.category}</h4>`;
                
                const optionsContainer = document.createElement('div');
                optionsContainer.className = 'service-options';
                
                category.items.forEach(service => {
                    const optionEl = document.createElement('div');
                    optionEl.className = 'service-option';
                    optionEl.textContent = service;
                    optionEl.onclick = () => selectService(service, categoryEl);
                    optionsContainer.appendChild(optionEl);
                });
                
                categoryEl.appendChild(optionsContainer);
                
                // Dodaj pole dla własnej usługi
                if (category.category === "📝 INNE USŁUGI") {
                    const inputEl = document.createElement('input');
                    inputEl.type = 'text';
                    inputEl.className = 'other-service-input';
                    inputEl.placeholder = "Wpisz nazwę usługi";
                    inputEl.style.display = 'none';
                    inputEl.oninput = function() {
                        selectedService = this.value;
                        document.getElementById('selected-service').textContent = this.value || 'Brak';
                    };
                    categoryEl.appendChild(inputEl);
                }
                
                container.appendChild(categoryEl);
            });
        }
        
        function selectService(service, categoryEl) {
            document.querySelectorAll('.service-option').forEach(el => {
                el.classList.remove('selected');
            });
            
            event.target.classList.add('selected');
            
            if (service === "Inna usługa...") {
                // Pokaż pole do wpisania własnej usługi
                const input = categoryEl.querySelector('.other-service-input');
                input.style.display = 'block';
                input.value = '';
                input.focus();
                selectedService = '';
                document.getElementById('selected-service').textContent = 'Brak';
            } else {
                // Ukryj wszystkie pola własnych usług
                document.querySelectorAll('.other-service-input').forEach(el => {
                    el.style.display = 'none';
                });
                selectedService = service;
                document.getElementById('selected-service').textContent = service;
            }
        }

        function updateAvailableTimes() {
            if (!currentEmployee || !currentDetailDay) return;
            
            const startHourSelect = document.getElementById('start-hour');
            const currentValue = startHourSelect.value;
            const availableTimes = getAvailableTimes();
            
            startHourSelect.innerHTML = '<option value="">Godzina rozpoczęcia</option>';
            
            availableTimes.forEach(time => {
                const option = document.createElement('option');
                option.value = time;
                option.textContent = time;
                if (time === currentValue) option.selected = true;
                startHourSelect.appendChild(option);
            });
        }

        function getAvailableTimes() {
            const dateKey = `${currentDetailYear}-${currentDetailMonth + 1}-${currentDetailDay}`;
            const employeeData = appointmentsData[currentEmployee] || {};
            const appointments = employeeData[dateKey] || [];
            const allTimes = [];
            
            // Harmonogram zaczyna się od 5:00
            for (let hour = 5; hour < 24; hour++) {
                for (let minute = 0; minute < 60; minute += 5) {
                    allTimes.push(`${hour.toString().padStart(2, '0')}:${minute.toString().padStart(2, '0')}`);
                }
            }
            
            if (appointments.length === 0) return allTimes;
            
            return allTimes.filter(time => {
                const timeMinutes = timeToMinutes(time);
                
                // Sprawdź kolizję z własnymi wizytami
                for (const appointment of appointments) {
                    const appStart = timeToMinutes(appointment.startTime);
                    const appEnd = timeToMinutes(appointment.endTime);
                    
                    if ((timeMinutes >= appStart && timeMinutes < appEnd) ||
                        (timeMinutes + selectedDuration > appStart && timeMinutes + selectedDuration <= appEnd) ||
                        (timeMinutes <= appStart && timeMinutes + selectedDuration >= appEnd)) {
                        return false;
                    }
                }
                
                // Sprawdź blokady pedicure u innych pracowników
                const otherEmployee = employeesData.find(e => e.id.toString() !== currentEmployee);
                if (otherEmployee) {
                    const otherEmployeeId = otherEmployee.id.toString();
                    const otherEmployeeData = appointmentsData[otherEmployeeId] || {};
                    const otherAppointments = otherEmployeeData[dateKey] || [];
                    
                    for (const appointment of otherAppointments) {
                        if (appointment.service.includes("PEDICURE")) {
                            const appStart = timeToMinutes(appointment.startTime);
                            const appEnd = timeToMinutes(appointment.endTime);
                            
                            if ((timeMinutes >= appStart && timeMinutes < appEnd) ||
                                (timeMinutes + selectedDuration > appStart && timeMinutes + selectedDuration <= appEnd) ||
                                (timeMinutes <= appStart && timeMinutes + selectedDuration >= appEnd)) {
                                return false;
                            }
                        }
                    }
                }
                
                return true;
            });
        }

        // Logowanie i wybór pracownika
        function login() {
            const password = document.getElementById('password').value;
            if (password === "1234") {
                document.getElementById('login-view').classList.remove('active-view');
                document.getElementById('employee-view').classList.add('active-view');
                document.getElementById('login-error').textContent = "";
                
                // Renderuj listę pracowników po zalogowaniu
                renderEmployeesList();
            } else {
                document.getElementById('login-error').textContent = "Błędne hasło!";
            }
        }
        
        // Obsługa klawisza Enter w polu hasła
        document.getElementById('password').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                login();
            }
        });

        function selectEmployee(employeeId) {
            currentEmployee = employeeId.toString();
            const employee = employeesData.find(e => e.id === employeeId);
            
            if (employee) {
                document.getElementById('employee-view').classList.remove('active-view');
                document.getElementById('calendar-view').classList.add('active-view');
                document.getElementById('employee-name').textContent = employee.name;
                
                // Utwórz pusty kalendarz jeśli pracownik nie istnieje
                if (!appointmentsData[currentEmployee]) {
                    appointmentsData[currentEmployee] = {};
                    localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
                }
                
                renderCalendar();
                initTimeOptions();
                updateMonthlySummary();
            } else {
                alert("Błąd: Nie znaleziono pracownika!");
            }
        }

        function switchEmployee() {
            document.getElementById('calendar-view').classList.remove('active-view');
            document.getElementById('employee-view').classList.add('active-view');
        }

        function addEmployee() {
            const name = document.getElementById('new-employee-name').value.trim();
            if (!name) {
                alert('Podaj imię i nazwisko pracownika!');
                return;
            }
            
            // Generuj nowe ID
            const newId = employeesData.length > 0 ? Math.max(...employeesData.map(e => e.id)) + 1 : 1;
            
            employeesData.push({ id: newId, name: name });
            localStorage.setItem('employeesData', JSON.stringify(employeesData));
            
            // Utwórz pusty kalendarz dla nowego pracownika
            appointmentsData[newId] = {};
            localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
            
            document.getElementById('new-employee-name').value = '';
            renderEmployeesList();
            renderEmployeesTable();
        }
        
        function editEmployee(employeeId) {
            const newName = prompt('Podaj nowe imię i nazwisko pracownika:');
            if (newName && newName.trim() !== '') {
                const employee = employeesData.find(e => e.id === employeeId);
                if (employee) {
                    employee.name = newName.trim();
                    localStorage.setItem('employeesData', JSON.stringify(employeesData));
                    // Jeśli edytujemy aktualnie zalogowanego pracownika, to aktualizujemy nagłówek
                    if (currentEmployee == employeeId) {
                        document.getElementById('employee-name').textContent = employee.name;
                    }
                    renderEmployeesList();
                    renderEmployeesTable();
                }
            }
        }
        
        function deleteEmployee(employeeId) {
            if (confirm('Czy na pewno chcesz usunąć tego pracownika? Wszystkie jego wizyty również zostaną usunięte.')) {
                // Usuń pracownika z listy
                employeesData = employeesData.filter(e => e.id !== employeeId);
                localStorage.setItem('employeesData', JSON.stringify(employeesData));
                
                // Usuń kalendarz pracownika
                delete appointmentsData[employeeId];
                localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
                
                // Jeśli usuwamy aktualnie zalogowanego pracownika, to wyloguj
                if (currentEmployee == employeeId) {
                    switchEmployee();
                } else {
                    renderEmployeesList();
                    renderEmployeesTable();
                }
                
                // Upewnij się, że nie próbujemy usunąć ostatniego pracownika
                if (employeesData.length === 0) {
                    // Dodaj domyślnego pracownika, aby uniknąć błędów
                    employeesData.push({ id: 1, name: "Nowy Pracownik" });
                    localStorage.setItem('employeesData', JSON.stringify(employeesData));
                    appointmentsData["1"] = {};
                    localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
                }
            }
        }

        // Kalendarz
        function renderCalendar() {
            const monthNames = [
                "Styczeń", "Luty", "Marzec", "Kwiecień", "Maj", "Czerwiec",
                "Lipiec", "Sierpień", "Wrzesień", "Październik", "Listopad", "Grudzień"
            ];
            
            document.getElementById('current-month').textContent = 
                `${monthNames[currentMonth]} ${currentYear}`;
            
            const calendarEl = document.getElementById('calendar');
            calendarEl.innerHTML = '';
            
            // Dodaj nagłówki dni tygodnia
            const daysOfWeek = ['Pon', 'Wto', 'Śro', 'Czw', 'Pią', 'Sob', 'Nie'];
            daysOfWeek.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'day-header';
                dayHeader.textContent = day;
                calendarEl.appendChild(dayHeader);
            });
            
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            // Dostosuj dla poniedziałku jako pierwszego dnia
            const adjustedFirstDay = firstDay === 0 ? 6 : firstDay - 1;
            
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            // Puste miejsca przed pierwszym dniem
            for (let i = 0; i < adjustedFirstDay; i++) {
                const emptyDay = document.createElement('div');
                emptyDay.className = 'day empty';
                calendarEl.appendChild(emptyDay);
            }
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dayEl = document.createElement('div');
                dayEl.className = 'day';
                
                // Dodaj nagłówek z nazwą dnia dla widoku mobilnego
                const dayHeaderMobile = document.createElement('div');
                dayHeaderMobile.className = 'day-header-mobile';
                dayHeaderMobile.textContent = daysOfWeek[(adjustedFirstDay + day - 1) % 7];
                dayEl.appendChild(dayHeaderMobile);
                
                if (day === currentDate.getDate() && 
                    currentMonth === currentDate.getMonth() && 
                    currentYear === currentDate.getFullYear()) {
                    dayEl.classList.add('today');
                }
                
                dayEl.onclick = () => showDayDetails(day, currentMonth, currentYear);
                
                const dayNumber = document.createElement('div');
                dayNumber.className = 'day-number';
                dayNumber.textContent = day;
                dayEl.appendChild(dayNumber);
                
                const dateKey = `${currentYear}-${currentMonth + 1}-${day}`;
                const employeeData = appointmentsData[currentEmployee] || {};
                const appointments = employeeData[dateKey] || [];
                
                appointments.forEach(appointment => {
                    const appointmentEl = document.createElement('div');
                    appointmentEl.className = 'appointment';
                    appointmentEl.textContent = `${appointment.startTime} ${appointment.clientName.substring(0, 10)}${appointment.clientName.length > 10 ? '...' : ''}`;
                    appointmentEl.title = `${appointment.clientName}\n${appointment.service}\n${appointment.startTime}-${appointment.endTime}`;
                    
                    // Dodaj informację o innym pracowniku
                    if (appointment.otherEmployee) {
                        const note = document.createElement('div');
                        note.className = 'other-employee-note';
                        note.textContent = `(${appointment.otherEmployee})`;
                        appointmentEl.appendChild(note);
                    }
                    
                    dayEl.appendChild(appointmentEl);
                });
                
                calendarEl.appendChild(dayEl);
            }
            
            updateMonthlySummary();
        }

        function showDayDetails(day, month, year) {
            // Ukryj przycisk zmiany pracownika w widoku dnia
            document.getElementById('switch-employee-btn').style.display = 'none';
            
            currentDetailDay = day;
            currentDetailMonth = month;
            currentDetailYear = year;
            
            const monthNames = [
                "Styczeń", "Luty", "Marzec", "Kwiecień", "Maj", "Czerwiec",
                "Lipiec", "Sierpień", "Wrzesień", "Październik", "Listopad", "Grudzień"
            ];
            
            document.getElementById('selected-day').textContent = 
                `${day} ${monthNames[month]} ${year}`;
            document.getElementById('calendar').style.display = 'none';
            document.getElementById('day-details').style.display = 'block';
            
            // Resetuj wybór usługi
            selectedService = "";
            document.getElementById('selected-service').textContent = "Brak";
            document.querySelectorAll('.service-option').forEach(el => {
                el.classList.remove('selected');
            });
            document.querySelectorAll('.other-service-input').forEach(el => {
                el.style.display = 'none';
            });
            
            renderDaySchedule();
            renderTimeline();
            updateAvailableTimes();
        }

        function navigateDay(direction) {
            // direction: -1 dla poprzedniego, 1 dla następnego
            const currentDate = new Date(currentDetailYear, currentDetailMonth, currentDetailDay);
            currentDate.setDate(currentDate.getDate() + direction);
            
            showDayDetails(
                currentDate.getDate(),
                currentDate.getMonth(),
                currentDate.getFullYear()
            );
        }

        function hideDayDetails() {
            // Przywróć przycisk zmiany pracownika
            document.getElementById('switch-employee-btn').style.display = 'block';
            
            document.getElementById('calendar').style.display = 'grid';
            document.getElementById('day-details').style.display = 'none';
        }

        // Zarządzanie wizytami
        function addAppointment() {
            const clientName = document.getElementById('client-name').value.trim();
            const clientPhone = document.getElementById('client-phone').value.trim();
            const startTime = document.getElementById('start-hour').value;
            
            if (!clientName || !selectedService || !startTime) {
                document.getElementById('time-error').textContent = 'Wypełnij wszystkie pola!';
                return;
            }
            
            // Zapisz klienta w bazie
            let clientExists = false;
            for (const client of clientsData) {
                if (client.name === clientName && client.phone === clientPhone) {
                    clientExists = true;
                    break;
                }
            }
            
            if (!clientExists) {
                clientsData.push({
                    name: clientName,
                    phone: clientPhone,
                    notes: ''
                });
                localStorage.setItem('clientsData', JSON.stringify(clientsData));
                renderClientsList();
            }
            
            const startMinutes = timeToMinutes(startTime);
            const endMinutes = startMinutes + selectedDuration;
            const endTime = minutesToTime(endMinutes);
            
            const dateKey = `${currentDetailYear}-${currentDetailMonth + 1}-${currentDetailDay}`;
            
            if (!appointmentsData[currentEmployee]) {
                appointmentsData[currentEmployee] = {};
            }
            
            const employeeData = appointmentsData[currentEmployee];
            
            if (!employeeData[dateKey]) {
                employeeData[dateKey] = [];
            }
            
            const appointments = employeeData[dateKey];
            
            // Sprawdź kolizję terminów
            for (const appointment of appointments) {
                const appStart = timeToMinutes(appointment.startTime);
                const appEnd = timeToMinutes(appointment.endTime);
                
                if ((startMinutes >= appStart && startMinutes < appEnd) ||
                    (endMinutes > appStart && endMinutes <= appEnd) ||
                    (startMinutes <= appStart && endMinutes >= appEnd)) {
                    document.getElementById('time-error').textContent = 'Termin koliduje z istniejącą wizytą!';
                    return;
                }
            }
            
            document.getElementById('time-error').textContent = '';
            
            // Sprawdź blokady pedicure u innych pracowników
            let otherEmployeeNote = '';
            const otherEmployee = employeesData.find(e => e.id.toString() !== currentEmployee);
            
            if (otherEmployee) {
                const otherEmployeeId = otherEmployee.id.toString();
                const otherEmployeeData = appointmentsData[otherEmployeeId] || {};
                const otherAppointments = otherEmployeeData[dateKey] || [];
                
                for (const appointment of otherAppointments) {
                    if (appointment.service.includes("PEDICURE")) {
                        const appStart = timeToMinutes(appointment.startTime);
                        const appEnd = timeToMinutes(appointment.endTime);
                        
                        if ((startMinutes >= appStart && startMinutes < appEnd) ||
                            (endMinutes > appStart && endMinutes <= appEnd) ||
                            (startMinutes <= appStart && endMinutes >= appEnd)) {
                            
                            // Dodaj informację o blokadzie
                            otherEmployeeNote = otherEmployee.name;
                            document.getElementById('time-error').textContent = 'Termin koliduje z wizytą pedicure innego pracownika!';
                            return;
                        }
                    }
                }
            }
            
            appointments.push({
                clientName: clientName,
                clientPhone: clientPhone,
                service: selectedService,
                startTime: startTime,
                endTime: endTime,
                duration: selectedDuration,
                price: 0,
                otherEmployee: otherEmployeeNote
            });
            
            appointments.sort((a, b) => timeToMinutes(a.startTime) - timeToMinutes(b.startTime));
            
            // Zapisz dane
            localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
            renderCalendar();
            
            // Resetuj formularz
            document.getElementById('client-name').value = '';
            document.getElementById('client-phone').value = '';
            selectedService = "";
            document.getElementById('selected-service').textContent = "Brak";
            document.querySelectorAll('.service-option').forEach(el => {
                el.classList.remove('selected');
            });
            document.querySelectorAll('.other-service-input').forEach(el => {
                el.style.display = 'none';
                el.value = '';
            });
            document.getElementById('start-hour').value = '';
            
            renderDaySchedule();
            renderTimeline();
            updateAvailableTimes();
            updateMonthlySummary();
        }

        function renderDaySchedule() {
            const dateKey = `${currentDetailYear}-${currentDetailMonth + 1}-${currentDetailDay}`;
            const scheduleEl = document.getElementById('day-schedule');
            scheduleEl.innerHTML = '';
            
            // Znajdź obu pracowników
            const currentEmployeeObj = employeesData.find(e => e.id.toString() === currentEmployee);
            const otherEmployee = employeesData.find(e => e.id.toString() !== currentEmployee);
            
            // Stwórz kontener
            const scheduleContainer = document.createElement('div');
            scheduleContainer.className = 'day-schedule';
            scheduleEl.appendChild(scheduleContainer);
            
            // Kolumna dla bieżącego pracownika
            const currentColumn = document.createElement('div');
            currentColumn.className = 'schedule-column';
            currentColumn.innerHTML = `<h3>${currentEmployeeObj.name}</h3>`;
            scheduleContainer.appendChild(currentColumn);
            
            // Pobierz wizyty bieżącego pracownika
            const currentEmployeeData = appointmentsData[currentEmployee] || {};
            const currentAppointments = currentEmployeeData[dateKey] || [];
            
            // Tabela dla bieżącego pracownika
            if (currentAppointments.length > 0) {
                const table = document.createElement('table');
                table.className = 'appointments-table';
                table.innerHTML = `
                    <thead>
                        <tr>
                            <th>Godziny</th>
                            <th>Klient</th>
                            <th>Usługa</th>
                            <th>Cena (zł)</th>
                            <th>Akcje</th>
                        </tr>
                    </thead>
                    <tbody>
                `;
                
                currentAppointments.forEach((appointment, index) => {
                    const row = document.createElement('tr');
                    if (appointment.service.includes("PEDICURE")) {
                        row.classList.add('pedicure-row');
                    }
                    
                    row.innerHTML = `
                        <td>${appointment.startTime}-${appointment.endTime}</td>
                        <td>${appointment.clientName}</td>
                        <td>${appointment.service}</td>
                        <td>
                            <input type="number" class="price-input" value="${appointment.price || ''}" 
                                   onchange="updateAppointmentPrice(${index}, this.value)"
                                   placeholder="Cena">
                        </td>
                        <td>
                            <button onclick="editAppointment(${index})">Edytuj</button>
                            <button class="delete" onclick="deleteAppointment(${index})">Usuń</button>
                        </td>
                    `;
                    table.querySelector('tbody').appendChild(row);
                });
                
                currentColumn.appendChild(table);
            } else {
                currentColumn.innerHTML += '<div class="empty-schedule">Brak wizyt</div>';
            }
            
            // Kolumna dla drugiego pracownika (tylko pedicure)
            if (otherEmployee) {
                const otherColumn = document.createElement('div');
                otherColumn.className = 'schedule-column';
                otherColumn.innerHTML = `<h3>${otherEmployee.name} (Pedicure)</h3>`;
                scheduleContainer.appendChild(otherColumn);
                
                // Pobierz wizyty drugiego pracownika
                const otherEmployeeData = appointmentsData[otherEmployee.id] || {};
                const otherAppointments = otherEmployeeData[dateKey] || [];
                const pedicureAppointments = otherAppointments.filter(app => app.service.includes("PEDICURE"));
                
                if (pedicureAppointments.length > 0) {
                    const table = document.createElement('table');
                    table.className = 'appointments-table';
                    table.innerHTML = `
                        <thead>
                            <tr>
                                <th>Godziny</th>
                                <th>Klient</th>
                                <th>Usługa</th>
                            </tr>
                        </thead>
                        <tbody>
                    `;
                    
                    pedicureAppointments.forEach(appointment => {
                        const row = document.createElement('tr');
                        row.classList.add('pedicure-row');
                        
                        row.innerHTML = `
                            <td>${appointment.startTime}-${appointment.endTime}</td>
                            <td>${appointment.clientName}</td>
                            <td>${appointment.service}</td>
                        `;
                        table.querySelector('tbody').appendChild(row);
                    });
                    
                    otherColumn.appendChild(table);
                } else {
                    otherColumn.innerHTML += '<div class="empty-schedule">Brak wizyt pedicure</div>';
                }
            }
            
            updateDaySummary();
        }
        
        function editAppointment(index) {
            const dateKey = `${currentDetailYear}-${currentDetailMonth + 1}-${currentDetailDay}`;
            const employeeData = appointmentsData[currentEmployee] || {};
            const appointments = employeeData[dateKey] || [];
            
            if (appointments[index]) {
                const app = appointments[index];
                const newService = prompt("Edytuj usługę:", app.service);
                if (newService !== null) {
                    app.service = newService;
                    localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
                    renderDaySchedule();
                    renderTimeline();
                    updateMonthlySummary();
                }
            }
        }

        function renderTimeline() {
            const container = document.getElementById('timeline-container');
            container.innerHTML = '';
            
            const dateKey = `${currentDetailYear}-${currentDetailMonth + 1}-${currentDetailDay}`;
            const employeeData = appointmentsData[currentEmployee] || {};
            const appointments = employeeData[dateKey] || [];
            
            // Renderuj normalne wizyty
            appointments.forEach(appointment => {
                const startMinutes = timeToMinutes(appointment.startTime);
                const endMinutes = timeToMinutes(appointment.endTime);
                const duration = endMinutes - startMinutes;
                
                const slot = document.createElement('div');
                slot.className = 'booked-slot';
                if (appointment.service.includes("PEDICURE")) {
                    slot.classList.add('pedicure-block');
                }
                slot.style.top = ((startMinutes/60 - 5) * 31.57) + 'px';
                slot.style.height = (duration/60 * 31.57) + 'px';
                
                const slotInfo = document.createElement('div');
                slotInfo.className = 'slot-info';
                slotInfo.innerHTML = `
                    <div>${appointment.clientName}</div>
                    <div>${appointment.service}</div>
                    <div>${appointment.startTime}-${appointment.endTime}</div>
                `;
                
                slot.appendChild(slotInfo);
                
                const deleteBtn = document.createElement('button');
                deleteBtn.className = 'slot-delete';
                deleteBtn.textContent = 'X';
                deleteBtn.onclick = (e) => {
                    e.stopPropagation();
                    deleteAppointmentByTime(appointment.startTime);
                };
                slot.appendChild(deleteBtn);
                
                container.appendChild(slot);
            });
            
            // Dodaj blokady pedicure z innych pracowników
            const otherEmployee = employeesData.find(e => e.id.toString() !== currentEmployee);
            if (otherEmployee) {
                const otherEmployeeId = otherEmployee.id.toString();
                const otherEmployeeData = appointmentsData[otherEmployeeId] || {};
                const otherAppointments = otherEmployeeData[dateKey] || [];
                
                otherAppointments.forEach(appointment => {
                    if (appointment.service.includes("PEDICURE")) {
                        const startMinutes = timeToMinutes(appointment.startTime);
                        const endMinutes = timeToMinutes(appointment.endTime);
                        const duration = endMinutes - startMinutes;
                        
                        const slot = document.createElement('div');
                        slot.className = 'booked-slot pedicure-blocked';
                        slot.style.top = ((startMinutes/60 - 5) * 31.57) + 'px';
                        slot.style.height = (duration/60 * 31.57) + 'px';
                        
                        const slotInfo = document.createElement('div');
                        slotInfo.className = 'slot-info';
                        slotInfo.innerHTML = `
                            <div>STANOWISKO ZAJĘTE</div>
                            <div>${appointment.service}</div>
                            <div>${appointment.startTime}-${appointment.endTime}</div>
                            <div>${otherEmployee.name}</div>
                        `;
                        slot.appendChild(slotInfo);
                        
                        container.appendChild(slot);
                    }
                });
            }
        }
        
        function deleteAppointmentByTime(startTime) {
            const dateKey = `${currentDetailYear}-${currentDetailMonth + 1}-${currentDetailDay}`;
            const employeeData = appointmentsData[currentEmployee] || {};
            const appointments = employeeData[dateKey] || [];
            
            const index = appointments.findIndex(app => app.startTime === startTime);
            if (index !== -1) {
                appointments.splice(index, 1);
                localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
                renderDaySchedule();
                renderTimeline();
                updateAvailableTimes();
                updateMonthlySummary();
            }
        }

        function updateAppointmentPrice(index, price) {
            const dateKey = `${currentDetailYear}-${currentDetailMonth + 1}-${currentDetailDay}`;
            const employeeData = appointmentsData[currentEmployee] || {};
            const appointments = employeeData[dateKey] || [];
            
            if (appointments[index]) {
                appointments[index].price = parseInt(price) || 0;
                localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
                updateDaySummary();
                updateMonthlySummary();
            }
        }

        function deleteAppointment(index) {
            const dateKey = `${currentDetailYear}-${currentDetailMonth + 1}-${currentDetailDay}`;
            const employeeData = appointmentsData[currentEmployee] || {};
            const appointments = employeeData[dateKey] || [];
            
            if (appointments[index]) {
                appointments.splice(index, 1);
                localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
                renderDaySchedule();
                renderTimeline();
                updateAvailableTimes();
                updateMonthlySummary();
            }
        }

        // Baza klientów
        function renderClientsList() {
            const clientsList = document.getElementById('clients-list');
            clientsList.innerHTML = '';
            
            clientsData.forEach((client, index) => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${client.name}</td>
                    <td>${client.phone}</td>
                    <td>${client.notes}</td>
                    <td>
                        <button onclick="editClient(${index})">Edytuj</button>
                        <button class="delete" onclick="deleteClient(${index})">Usuń</button>
                    </td>
                `;
                clientsList.appendChild(row);
            });
        }
        
        function addClient() {
            const name = document.getElementById('new-client-name').value.trim();
            const phone = document.getElementById('new-client-phone').value.trim();
            const notes = document.getElementById('new-client-notes').value.trim();
            
            if (!name) {
                alert('Podaj imię i nazwisko klienta!');
                return;
            }
            
            clientsData.push({ name, phone, notes });
            localStorage.setItem('clientsData', JSON.stringify(clientsData));
            
            document.getElementById('new-client-name').value = '';
            document.getElementById('new-client-phone').value = '';
            document.getElementById('new-client-notes').value = '';
            
            renderClientsList();
        }
        
        function editClient(index) {
            const client = clientsData[index];
            const newNotes = prompt('Edytuj notatki o kliencie:', client.notes);
            
            if (newNotes !== null) {
                client.notes = newNotes;
                localStorage.setItem('clientsData', JSON.stringify(clientsData));
                renderClientsList();
            }
        }
        
        function deleteClient(index) {
            if (confirm('Czy na pewno chcesz usunąć tego klienta?')) {
                clientsData.splice(index, 1);
                localStorage.setItem('clientsData', JSON.stringify(clientsData));
                renderClientsList();
            }
        }

        // Podsumowania
        function updateDaySummary() {
            const dateKey = `${currentDetailYear}-${currentDetailMonth + 1}-${currentDetailDay}`;
            const employeeData = appointmentsData[currentEmployee] || {};
            const appointments = employeeData[dateKey] || [];
            
            document.getElementById('day-count').textContent = appointments.length;
            
            const total = appointments.reduce((sum, app) => sum + (app.price || 0), 0);
            document.getElementById('day-earnings').textContent = total;
        }
        
        function updateMonthlySummary() {
            if (!currentEmployee) return;
            
            let total = 0;
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const employeeData = appointmentsData[currentEmployee] || {};
            
            for (let day = 1; day <= daysInMonth; day++) {
                const dateKey = `${currentYear}-${currentMonth + 1}-${day}`;
                const appointments = employeeData[dateKey] || [];
                
                total += appointments.reduce((sum, app) => sum + (app.price || 0), 0);
            }
            
            document.getElementById('monthly-earnings').textContent = total;
        }
        
        function resetDayStats() {
            const dateKey = `${currentDetailYear}-${currentDetailMonth + 1}-${currentDetailDay}`;
            const employeeData = appointmentsData[currentEmployee] || {};
            const appointments = employeeData[dateKey] || [];
            
            if (appointments.length === 0) return;
            
            if (confirm('Czy na pewno chcesz wyzerować zarobki tego dnia?')) {
                appointments.forEach(appointment => {
                    appointment.price = 0;
                });
                
                localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
                renderDaySchedule();
                updateDaySummary();
                updateMonthlySummary();
            }
        }
        
        function resetMonthlyStats() {
            if (!currentEmployee) return;
            
            const employeeData = appointmentsData[currentEmployee] || {};
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            
            if (confirm('Czy na pewno chcesz wyzerować statystyki tego miesiąca?')) {
                for (let day = 1; day <= daysInMonth; day++) {
                    const dateKey = `${currentYear}-${currentMonth + 1}-${day}`;
                    const appointments = employeeData[dateKey] || [];
                    
                    appointments.forEach(appointment => {
                        appointment.price = 0;
                    });
                }
                
                localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
                updateMonthlySummary();
                
                if (selectedDay) {
                    renderDaySchedule();
                    updateDaySummary();
                }
            }
        }
        
        function resetAllStats() {
            if (confirm('Czy na pewno chcesz wyzerować wszystkie statystyki?')) {
                for (const employeeId in appointmentsData) {
                    const employeeData = appointmentsData[employeeId];
                    
                    for (const dateKey in employeeData) {
                        const appointments = employeeData[dateKey];
                        
                        appointments.forEach(appointment => {
                            appointment.price = 0;
                        });
                    }
                }
                
                localStorage.setItem('appointmentsData', JSON.stringify(appointmentsData));
                
                if (currentEmployee) {
                    updateMonthlySummary();
                    
                    if (selectedDay) {
                        renderDaySchedule();
                        updateDaySummary();
                    }
                }
            }
        }
        
        function renderEmployeeStats() {
            const container = document.getElementById('employee-stats-container');
            container.innerHTML = '';
            
            employeesData.forEach(employee => {
                const employeeId = employee.id.toString();
                const employeeData = appointmentsData[employeeId] || {};
                
                // Oblicz statystyki
                let totalEarnings = 0;
                let appointmentCount = 0;
                let newClients = 0;
                
                for (const dateKey in employeeData) {
                    const appointments = employeeData[dateKey];
                    appointmentCount += appointments.length;
                    
                    appointments.forEach(appointment => {
                        totalEarnings += appointment.price || 0;
                    });
                }
                
                // Statystyki dla tego pracownika
                const statBox = document.createElement('div');
                statBox.className = 'stat-box';
                statBox.innerHTML = `
                    <h3>${employee.name}</h3>
                    <div class="stat-value">${totalEarnings} zł</div>
                    <div class="stat-label">Łączne zarobki</div>
                    <div class="stat-value">${appointmentCount}</div>
                    <div class="stat-label">Wykonane usługi</div>
                    <div class="stat-value">${newClients}</div>
                    <div class="stat-label">Nowi klienci</div>
                `;
                
                container.appendChild(statBox);
            });
        }
        
        function showCurrentDate() {
            currentDate = new Date();
            currentMonth = currentDate.getMonth();
            currentYear = currentDate.getFullYear();
            renderCalendar();
        }

        // Start aplikacji
        window.onload = function() {
            // Inicjalizuj dane jeśli nie istnieją
            if (localStorage.getItem('employeesData') === null) {
                localStorage.setItem('employeesData', JSON.stringify([
                    { id: 1, name: "Wiktoria Wozowicz-Świniuch" },
                    { id: 2, name: "Weronika Dyło" }
                ]));
            }
            
            if (localStorage.getItem('appointmentsData') === null) {
                localStorage.setItem('appointmentsData', JSON.stringify({
                    "1": {},
                    "2": {}
                }));
            }
            
            if (localStorage.getItem('clientsData') === null) {
                localStorage.setItem('clientsData', JSON.stringify([]));
            }
            
            // Wczytaj dane
            employeesData = JSON.parse(localStorage.getItem('employeesData')) || [];
            appointmentsData = JSON.parse(localStorage.getItem('appointmentsData')) || {};
            clientsData = JSON.parse(localStorage.getItem('clientsData')) || [];
            
            // Wyświetl ekran logowania
            document.getElementById('login-view').classList.add('active-view');
            
            // Inicjalizuj opcje czasu
            initTimeOptions();
        };

        // Obsługa nawigacji kalendarza
        document.getElementById('prev-month').addEventListener('click', () => {
            currentMonth--;
            if (currentMonth < 0) {
                currentMonth = 11;
                currentYear--;
            }
            renderCalendar();
        });

        document.getElementById('next-month').addEventListener('click', () => {
            currentMonth++;
            if (currentMonth > 11) {
                currentMonth = 0;
                currentYear++;
            }
            renderCalendar();
        });
    </script>
</body>
</html>